import React, { useState, useEffect } from 'react';
import { ChevronLeft, ChevronRight, Moon, Sun } from 'lucide-react';

const App = () => {
  const [isUnsungMode, setIsUnsungMode] = useState(false);
  const [currentCharIndex, setCurrentCharIndex] = useState(0);

  const characters = [
    {
      id: "pc1",
      name: "蛇場見 マコト",
      ruby: "MAKOTO JABAMI",
      cv: "CV: ???",
      description: "本キャンペーンの主人公（バインダー）。なでことの約束である「キャンプ」を心待ちにしている女子高生。過去の事故をきっかけに異界に惹かれやすい体質となってしまった。しっかり者に見えて、なでこの前では年相応の顔を見せる。",
      color: "#E67E22",
      bgText: "蛇場見真琴",
      image: "https://lh3.googleusercontent.com/u/0/d/1R7xEalrDGGUiF_-RRB7UkNrkWr3J769m", // 仮でKVを使用、本来はマコト立ち絵
      expressions: [
        "https://placehold.jp/24/e67e22/ffffff/200x200.png?text=通常",
        "https://placehold.jp/24/e67e22/ffffff/200x200.png?text=笑顔",
        "https://placehold.jp/24/e67e22/ffffff/200x200.png?text=困り顔"
      ]
    },
    {
      id: "pc2",
      name: "川根 なでこ",
      ruby: "NADEKO KAWANE",
      cv: "CV: ???",
      description: "マコトのパートナー（シフター）。明るく天真爛漫な性格で、マコトを外の世界へ、そしてキャンプへと連れ出した。彼女の存在がマコトにとっての「日常」の象徴であり、異界からの帰還を支える光となっている。",
      color: "#F39C12",
      bgText: "川根なでこ",
      image: "https://placehold.jp/60/f39c12/ffffff/500x800.png?text=川根なでこ立ち絵",
      expressions: [
        "https://placehold.jp/24/f39c12/ffffff/200x200.png?text=元気",
        "https://placehold.jp/24/f39c12/ffffff/200x200.png?text=驚き",
        "https://placehold.jp/24/f39c12/ffffff/200x200.png?text=照れ"
      ]
    },
    {
      id: "npc",
      name: "ユーリ先生",
      ruby: "YURI-SENSEI",
      cv: "CV: ???",
      description: "マコトたちの学校の顧問。時に厳しく、時に優しく二人を見守る大人。彼女の別荘がある清里への旅行が、物語の新たな転換点となった。異界についても何か知っている節がある……？",
      color: "#8E44AD",
      bgText: "ユーリ",
      image: "https://placehold.jp/60/8e44ad/ffffff/500x800.png?text=NPC立ち絵",
      expressions: [
        "https://placehold.jp/24/8e44ad/ffffff/200x200.png?text=微笑",
        "https://placehold.jp/24/8e44ad/ffffff/200x200.png?text=考え事",
        "https://placehold.jp/24/8e44ad/ffffff/200x200.png?text=厳格"
      ]
    }
  ];

  const nextChar = () => setCurrentCharIndex((prev) => (prev + 1) % characters.length);
  const prevChar = () => setCurrentCharIndex((prev) => (prev - 1 + characters.length) % characters.length);

  const current = characters[currentCharIndex];

  return (
    <div className={`min-h-screen transition-colors duration-700 font-['Zen_Maru_Gothic'] relative overflow-x-hidden ${isUnsungMode ? 'bg-[#121212] text-[#D5D8DC]' : 'bg-[#FFF9F0] text-[#5D4037]'}`}>
      
      {/* 共通のノイズ背景演出 */}
      <div className="fixed inset-0 pointer-events-none opacity-[0.03]" style={{ backgroundImage: `url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' /%3E%3C/svg%3E")` }}></div>

      {/* ヘッダー */}
      <header className="container mx-auto pt-10 text-center relative z-10 px-4">
        <h1 className={`text-4xl md:text-5xl font-bold mb-2 tracking-widest transition-colors duration-500 ${isUnsungMode ? 'text-[#8E44AD]' : 'text-[#E67E22]'}`}>
          ゆるデュオ△
        </h1>
        <nav className="flex justify-center gap-3 mt-6 flex-wrap">
          {['Top', 'Story', 'Character', 'World', 'Movie'].map((item) => (
            <a 
              key={item}
              href="#" 
              className={`px-5 py-2 rounded-full border-2 font-bold text-sm transition-all shadow-[3px_3px_0px] hover:-translate-y-1 hover:shadow-[5px_5px_0px] 
                ${isUnsungMode 
                  ? 'bg-[#1E1E1E] border-[#8E44AD] text-white shadow-[#8E44AD]' 
                  : 'bg-white border-[#E67E22] text-[#5D4037] shadow-[#E67E22]'}`}
            >
              {item}
            </a>
          ))}
        </nav>
      </header>

      {/* キャラクター表示エリア */}
      <main className="container mx-auto px-4 mt-8 pb-24 relative flex flex-col items-center">
        
        <div className="w-full max-w-5xl relative flex flex-col md:flex-row items-center justify-center min-h-[600px]">
          
          {/* 背景の巨大テキスト */}
          <div className={`absolute left-0 top-1/2 -translate-y-1/2 text-8xl md:text-[10rem] font-bold opacity-10 pointer-events-none whitespace-nowrap transition-colors duration-500 hidden lg:block`} 
               style={{ writingMode: 'vertical-rl', color: isUnsungMode ? '#8E44AD' : '#E67E22' }}>
            {current.bgText}
          </div>

          {/* 左右のナビゲーション矢印 */}
          <button onClick={prevChar} className="absolute left-0 z-50 p-4 transition-transform hover:scale-125">
            <ChevronLeft size={64} className={isUnsungMode ? 'text-[#8E44AD]' : 'text-[#E67E22]'} />
          </button>
          <button onClick={nextChar} className="absolute right-0 md:right-20 z-50 p-4 transition-transform hover:scale-125">
            <ChevronRight size={64} className={isUnsungMode ? 'text-[#8E44AD]' : 'text-[#E67E22]'} />
          </button>

          {/* メインビジュアルエリア */}
          <div className="relative z-20 flex justify-center items-center w-full max-w-lg">
            
            {/* 表情差分アイコン */}
            <div className="absolute inset-0 z-30 pointer-events-none">
               {current.expressions.map((src, i) => (
                 <div key={i} 
                    className={`absolute w-24 h-24 md:w-32 md:h-32 rounded-full border-4 overflow-hidden shadow-xl animate-bounce pointer-events-auto bg-white transition-all duration-500
                      ${i === 0 ? 'top-[-20px] left-[10%]' : i === 1 ? 'bottom-[10%] left-[-10%]' : 'bottom-[5%] right-[-5%]'}
                      ${isUnsungMode ? 'border-[#8E44AD] filter grayscale contrast-125' : 'border-[#F39C12]'}`}
                    style={{ animationDelay: `${i * 0.5}s`, animationDuration: '4s' }}>
                   <img src={src} alt="表情" className="w-full h-full object-cover" />
                 </div>
               ))}
            </div>

            {/* 立ち絵本体 */}
            <div className={`transition-all duration-700 max-h-[70vh] ${isUnsungMode ? 'filter grayscale(0.5) contrast(1.2) brightness(0.7) hue-rotate(180deg)' : 'drop-shadow-2xl'}`}>
              <img src={current.image} alt={current.name} className="h-full w-auto object-contain rounded-lg" />
            </div>
          </div>

          {/* 右サイドのセレクター（デスクトップ用） */}
          <div className="absolute right-0 top-1/2 -translate-y-1/2 hidden md:flex flex-col gap-4 z-50">
            {characters.map((char, index) => (
              <button 
                key={char.id}
                onClick={() => setCurrentCharIndex(index)}
                className={`w-16 h-16 rounded-full overflow-hidden border-4 transition-all hover:scale-110 
                  ${currentCharIndex === index ? (isUnsungMode ? 'border-[#8E44AD] scale-110' : 'border-[#E67E22] scale-110') : 'border-transparent opacity-60'}`}
              >
                <img src={char.expressions[0]} alt={char.name} className="w-full h-full object-cover" />
              </button>
            ))}
          </div>
        </div>

        {/* 紹介テキストエリア */}
        <div className={`mt-12 w-full max-w-2xl p-8 rounded-3xl transition-all duration-500 relative z-40
          ${isUnsungMode ? 'bg-[#1E1E1E] shadow-[0_10px_40px_rgba(0,0,0,0.5)] border border-[#8E44AD]/30' : 'bg-white shadow-[0_10px_40px_rgba(0,0,0,0.05)]'}`}>
          <div className={`inline-block px-4 py-1 mb-4 text-xs font-bold tracking-widest text-white transform -rotate-1 ${isUnsungMode ? 'bg-[#8E44AD]' : 'bg-[#F39C12]'}`}>
            {current.ruby}
          </div>
          <div className="flex justify-between items-end mb-4">
            <h2 className={`text-3xl font-bold ${isUnsungMode ? 'text-[#8E44AD]' : 'text-[#E67E22]'}`}>{current.name}</h2>
            <span className="text-sm opacity-60">{current.cv}</span>
          </div>
          <p className="text-lg leading-relaxed opacity-90">
            {current.description}
          </p>
        </div>
      </main>

      {/* フッター */}
      <footer className="text-center py-10 opacity-40 text-sm relative z-10">
        <p>&copy; ゆるデュオ△ 制作委員会 / Unsung Duet Project</p>
      </footer>

      {/* モード切替ボタン */}
      <button 
        onClick={() => setIsUnsungMode(!isUnsungMode)}
        className={`fixed bottom-8 right-8 w-14 h-14 rounded-full flex items-center justify-center transition-all duration-500 shadow-lg z-[100] hover:rotate-12 active:scale-95
          ${isUnsungMode ? 'bg-[#8E44AD] text-white' : 'bg-[#E67E22] text-white'}`}
      >
        {isUnsungMode ? <Moon size={28} /> : <Sun size={28} />}
      </button>

    </div>
  );
};

export default App;